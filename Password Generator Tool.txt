<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Password Generator with PDF + QR</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background:#1a1a1d;
      color:#f5f5f5;
      text-align:center;
      padding:20px;
    }
    .container {
      max-width:800px;
      margin:auto;
      background:#2c2c34;
      padding:20px;
      border-radius:12px;
      box-shadow:0 0 15px rgba(0,0,0,0.4);
    }
    h1 { color:#00ffff; }
    label { margin:10px; display:inline-block; }
    .button {
      margin:5px;
      padding:10px 20px;
      border:none;
      border-radius:6px;
      cursor:pointer;
      font-weight:bold;
    }
    .generate { background:linear-gradient(45deg,#ff00ff,#00ffff); color:#000; }
    .copy { background:#008CBA; color:white; }
    .download { background:#4CAF50; color:white; }
    #password-text {
      font-size:22px;
      margin:15px 0;
      color:#00ffff;
      word-wrap:break-word;
    }
    canvas { margin-top:15px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîê Password Generator</h1>

    <label>Password Length: <span id="passLengthValue">16</span></label><br>
    <input type="range" id="passLength" min="8" max="64" value="16"><br><br>

    <label><input type="checkbox" id="includeUppercase" checked> Uppercase</label>
    <label><input type="checkbox" id="includeLowercase" checked> Lowercase</label>
    <label><input type="checkbox" id="includeNumbers" checked> Numbers</label>
    <label><input type="checkbox" id="includeSymbols" checked> Symbols</label>
    <br><br>

    <button id="generateBtn" class="button generate">Generate</button>
    <button id="copyBtn" class="button copy">Copy</button>
    <button id="downloadTxtBtn" class="button download">Download .txt</button>
    <button id="downloadPdfBtn" class="button download">Download .pdf (with QR)</button>
    <button id="downloadQrBtn" class="button download">Download QR</button>

    <p id="password-text"></p>
    <canvas id="qrcode"></canvas>
  </div>

  <!-- QR + PDF Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
    const passLength = document.getElementById("passLength");
    const passLengthValue = document.getElementById("passLengthValue");
    const passwordText = document.getElementById("password-text");
    const qrCanvas = document.getElementById("qrcode");
    let currentPassword = "";
    let optionsUsed = {};

    passLength.addEventListener("input", () => 
      passLengthValue.textContent = passLength.value
    );

    function generatePassword() {
      const length = parseInt(passLength.value);
      const upper = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      const lower = "abcdefghijklmnopqrstuvwxyz";
      const nums = "0123456789";
      const syms = "!@#$%^&*()_+~`|}{[]:;?><,./-=";
      let pool = "";
      optionsUsed = {
        uppercase: document.getElementById("includeUppercase").checked,
        lowercase: document.getElementById("includeLowercase").checked,
        numbers: document.getElementById("includeNumbers").checked,
        symbols: document.getElementById("includeSymbols").checked,
        length: length
      };

      if (optionsUsed.uppercase) pool += upper;
      if (optionsUsed.lowercase) pool += lower;
      if (optionsUsed.numbers) pool += nums;
      if (optionsUsed.symbols) pool += syms;
      if (!pool) pool = lower;

      let pass = "";
      for (let i = 0; i < length; i++) {
        pass += pool.charAt(Math.floor(Math.random() * pool.length));
      }
      return pass;
    }

    function updatePassword() {
      currentPassword = generatePassword();
      passwordText.textContent = currentPassword;

      QRCode.toCanvas(qrCanvas, currentPassword, { width: 150 }, (err) => {
        if (err) console.error(err);
      });
    }

    document.getElementById("generateBtn").addEventListener("click", updatePassword);

    document.getElementById("copyBtn").addEventListener("click", () => {
      if (!currentPassword) return alert("Generate a password first!");
      navigator.clipboard.writeText(currentPassword);
      alert("Password copied to clipboard!");
    });

    document.getElementById("downloadTxtBtn").addEventListener("click", () => {
      if (!currentPassword) return alert("Generate a password first!");
      const blob = new Blob([currentPassword], { type: "text/plain" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "password.txt";
      link.click();
    });

    document.getElementById("downloadPdfBtn").addEventListener("click", () => {
      if (!currentPassword) return alert("Generate a password first!");
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      const timestamp = new Date().toLocaleString();

      doc.setFontSize(20);
      doc.text("üîê Generated Password Report", 20, 30);

      doc.setFontSize(14);
      doc.text("Password:", 20, 50);
      doc.text(currentPassword, 50, 50);

      doc.text("Length: " + optionsUsed.length, 20, 65);
      doc.text("Uppercase: " + (optionsUsed.uppercase ? "Yes" : "No"), 20, 75);
      doc.text("Lowercase: " + (optionsUsed.lowercase ? "Yes" : "No"), 20, 85);
      doc.text("Numbers: " + (optionsUsed.numbers ? "Yes" : "No"), 20, 95);
      doc.text("Symbols: " + (optionsUsed.symbols ? "Yes" : "No"), 20, 105);

      doc.text("Generated at: " + timestamp, 20, 120);

      const qrDataUrl = qrCanvas.toDataURL("image/png");
      doc.addImage(qrDataUrl, "PNG", 20, 140, 50, 50);

      doc.save("password_with_metadata.pdf");
    });

    document.getElementById("downloadQrBtn").addEventListener("click", () => {
      if (!currentPassword) return alert("Generate a password first!");
      const link = document.createElement("a");
      link.href = qrCanvas.toDataURL("image/png");
      link.download = "password_qr.png";
      link.click();
    });
  </script>
</body>
</html>